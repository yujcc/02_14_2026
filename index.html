<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Valentine Project</title>

    <!-- Browser Favicon-->
    <link rel="icon" type="image/png" href="assets/penta.png">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Cherry+Bomb+One&family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">

    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/phosphor-icons"></script>

    <!-- KaTeX for Math Rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
</head>

<body>

    <!-- Desktop Layer -->
    <div class="desktop">

        <!-- Desktop Folder Icon -->
        <div class="desktop-icon" id="open-folder">
            <img src="assets/folder_pink.png" alt="Love Logic Folder" class="custom-folder">
            <span>Do it. I dare you</span>
        </div>

    </div>

    <!-- Finder Window -->
    <div class="window finder hidden" id="finder-window">
        <div class="window-header">
            <div class="window-controls">
                <div class="control red"></div>
                <div class="control yellow"></div>
                <div class="control green"></div>
            </div>
            <div class="window-title">Love_Logic</div>
            <i class="ph-heart header-icon"></i>
        </div>

        <div class="content finder-grid">
            <div class="file-icon" id="start-game">
                <i class="ph ph-file-x"></i>
                <span>Hmph.exe</span>
            </div>
        </div>
    </div>

    <!-- Game Window -->
    <div class="window game hidden" id="game-window">
        <div class="window-header">
            <div class="window-controls">
                <div class="control red"></div>
                <div class="control yellow"></div>
                <div class="control green"></div>
            </div>
            <div class="window-title">Hmph.exe</div>
            <i class="ph-heart header-icon"></i>
        </div>

        <div class="content">

            <!-- VIEW 0: Start Screen -->
            <div id="start-screen">
                <div class="hero">
                    <h1>„Éö„É≥„Çø„Åï„Çì</h1>
                    <p>Are you Ready?</p>
                </div>
                <div class="center">
                    <button class="btn" onclick="startLoadingSequence()">
                        <i class="ph-play"></i> Launch
                    </button>
                </div>
            </div>

            <!-- VIEW 0.5: Loading Screen -->
            <div id="loading-screen" class="hidden">
                <div class="loading-main">
                    <img src="assets/penta_running.gif" alt="Running Penta" class="loading-gif">
                    <div class="loading-wave">
                        <div class="loading-dot"></div>
                        <div class="loading-dot"></div>
                        <div class="loading-dot"></div>
                    </div>
                </div>
                <div class="loading-footer">
                    <h2>Loading Assets...</h2>
                </div>
            </div>

            <!-- VIEW 1: Character Selection (Console) -->
            <div id="character-select-view" class="hidden">
                <div class="penta-console-container">

                    <!-- Top Console Card -->
                    <div class="console-card">
                        <div class="console-top-dots"><span></span><span></span></div>

                        <!-- Navigation Arrows (Subtle) -->
                        <button class="console-arrow l" onclick="moveCarousel(-1)">‚óÄ</button>
                        <button class="console-arrow r" onclick="moveCarousel(1)">‚ñ∂</button>

                        <div class="console-screen">
                            <div class="nb-carousel-viewport">
                                <div class="nb-carousel-track" id="carousel-track">
                                    <div class="nb-carousel-slide"><img src="assets/penta_wizard.png" class="slide-img"
                                            alt="Wizard"></div>
                                    <div class="nb-carousel-slide"><img src="assets/penta_chef.png" class="slide-img"
                                            alt="Chef"></div>
                                    <div class="nb-carousel-slide"><img src="assets/penta_cupid.png" class="slide-img"
                                            alt="Cupid"></div>
                                </div>
                            </div>
                        </div>

                        <div class="console-bottom-details">
                            <div class="red-dot"></div>
                            <div class="speaker-grille"><span></span><span></span><span></span></div>
                        </div>
                    </div>

                    <!-- Pagination Dots -->
                    <div class="pagination-dots" id="pagination-dots">
                        <span class="dot active"></span>
                        <span class="dot"></span>
                        <span class="dot"></span>
                    </div>

                    <!-- Info Box -->
                    <div class="info-box">
                        <h2 id="char-title">The Math Wizard</h2>
                        <p id="char-desc">Logic. Patterns. Chaos equations.</p>

                        <div class="char-stats">
                            <div class="stat-row">
                                <span class="stat-label">IQ</span>
                                <div class="stat-bar-bg">
                                    <div id="stat-iq" class="stat-bar-fill"></div>
                                </div>
                            </div>
                            <div class="stat-row">
                                <span class="stat-label">EQ</span>
                                <div class="stat-bar-bg">
                                    <div id="stat-eq" class="stat-bar-fill"></div>
                                </div>
                            </div>
                            <div class="stat-row">
                                <span class="stat-label">DET</span>
                                <div class="stat-bar-bg">
                                    <div id="stat-det" class="stat-bar-fill"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Button -->
                    <button class="get-started-btn" onclick="confirmSelection()">Get Started!</button>
                </div>
            </div>

            <!-- VIEW 2: Game Question -->
            <div id="game-view" class="hidden">
                <div class="avatar-header">
                    <div class="avatar">
                        <div class="mask mask-heart">
                            <img id="game-avatar" src="" alt="Penta" />
                        </div>
                    </div>
                </div>
                <div class="hero">
                    <h2 id="question-text" class="question-text">Question goes here...</h2>
                </div>
                <div id="options-container" class="options-grid">
                    <!-- Buttons injected by JS -->
                </div>
            </div>

            <!-- VIEW 3: Result -->
            <div id="result-view" class="hidden">
                <div class="hero">
                    <h1 id="result-title">Success!</h1>
                    <p id="result-desc">You did it!</p>
                </div>
                <!-- Optional: Restart Button -->
                <div class="center">
                    <button class="btn" onclick="restartGame()">Play Again</button>
                </div>
            </div>

        </div>

    </div>

    <div class="footer">
        0 I ‚Ä¢ 2 O ‚Ä¢ 5 U
    </div>

    <!-- Collapsible Home Menu -->
    <div class="home-menu-container">

        <!-- Menu Options (Hidden by default) -->
        <div class="menu-options" id="menu-options">
            <button class="menu-btn" onclick="toggleMusic()" title="Music On/Off">
                <i class="ph-music-notes-simple"></i>
            </button>
            <button class="menu-btn" onclick="showMessageModal()" title="Message">
                <i class="ph ph-heart-break"></i>
            </button>
            <button class="menu-btn" onclick="goBack()" title="Go Back">
                <i class="ph-arrow-bend-up-left"></i>
            </button>
            <button class="menu-btn reset-btn" onclick="resetProgress()" title="Reset All Progress">
                <i class="ph ph-trash"></i>
            </button>
        </div>

        <!-- Main Toggle Button -->
        <button class="menu-trigger" id="menu-trigger" onclick="toggleMenu()">
            <i class="ph-list"></i>
        </button>

    </div>

    <!-- Custom Modal (Hidden by default) -->
    <div id="custom-modal" class="modal-overlay hidden" onclick="closeModal(event)">
        <div class="modal-box">
            <button class="modal-close" onclick="closeModal(event)">
                <i class="ph-x"></i>
            </button>
            <i class="ph-heart-straight-fill modal-heart-icon"></i>
            <h3>Love Note</h3>
            <p>You are loved! üíñ<br>(This is a reminder from the Universe)</p>
        </div>
    </div>

    <!-- Mastery Modal (Hidden by default) -->
    <div id="mastery-modal" class="modal-overlay hidden" onclick="closeMasteryModal(event)">
        <div class="mastery-box">
            <button class="modal-close"
                onclick="document.getElementById('mastery-modal').classList.add('hidden')">&times;</button>
            <div class="modal-trophy-icon">üèÜ</div>
            <h2 id="mastery-title" class="mastery-title">Character Mastered! ‚ú®</h2>
            <div id="mastery-desc" class="mastery-desc">Congratulations! You've master this character's path.</div>
        </div>
    </div>

    <!-- Generic System Modal / Confirmation -->
    <div id="system-modal" class="modal-overlay hidden">
        <div class="modal-box">
            <div id="system-icon" class="modal-heart-icon">‚ö†Ô∏è</div>
            <h2 id="system-title" class="modal-title">System Message</h2>
            <div id="system-desc" class="modal-desc">This is a system message.</div>
            <div class="modal-footer" id="system-footer">
                <button class="btn" onclick="closeSystemModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Animation Overlays -->
    <div id="wizardSpell" class="spell-overlay hidden">
        <div class="spell-circle"></div>
        <div class="spell-lightning"></div>
    </div>

    <!-- Chef Animation Placeholder -->
    <div id="chefAnimation" class="spell-overlay hidden">
        <div id="cash-rain-container"></div>
    </div>

    <!-- Cupid Animation Placeholder -->
    <div id="cupidAnimation" class="spell-overlay hidden">
        <div id="heart-rain-container"></div>
    </div>

    <!-- Secret Master Quest Modal -->
    <div id="secret-quest-modal" class="modal-overlay hidden">
        <div class="modal-box quest-box">
            <div class="modal-heart-icon">üß™</div>
            <h2 class="modal-title">The Final Proof</h2>
            <div class="quest-content">
                <p class="math-formula">\(z(t) \approx \sum_{n=-4}^{4} c_n e^{i n t}\)</p>
                <p>The dominant coefficient is \(c_{-1} \approx 0.976i\) (after normalization).</p>
                <p class="quest-question">Which single term (when added to the constant \(c_0\)) contributes most to the
                    characteristic cleft and pointed bottom of the heart shape?
                </p>
                <div id="quest-options" class="options-grid">
                    <!-- Options injected by JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- Grand Finale Present Modal -->
    <div id="finale-modal" class="modal-overlay hidden">
        <div class="modal-box finale-box">
            <div id="finale-icon" class="modal-heart-icon">üéÅ</div>
            <h2 id="finale-title" class="modal-title">A Gift for You</h2>
            <div id="finale-desc" class="modal-desc"></div>
            <div id="present-container" class="present-container hidden">
                <div class="tracking-card">
                    <span class="tracking-label">Tracking Number:</span>
                    <span class="tracking-value">9434640106147000105469</span>
                </div>
            </div>
            <div class="modal-footer">
                <button id="present-btn" class="btn btn-primary" onclick="game.openPresent()">Open Present</button>
            </div>
        </div>
    </div>

    <div id="rose-animation-container"></div>

    <!-- Fourier Heart Animation (Master Egg Preview) -->
    <div id="fourier-container" class="spell-overlay hidden">
        <canvas id="fourier-canvas"></canvas>
        <div id="fourier-message" class="fourier-message">Happy Valentines!</div>
    </div>

    <script src="game_data.js"></script>
    <script src="game_logic.js"></script>
    <script src="main.js"></script>
</body>

</html>